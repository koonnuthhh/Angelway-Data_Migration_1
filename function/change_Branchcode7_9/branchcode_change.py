import pandas as pd
import os

# Load mapping
mapping_dict = {
    '6000': '1000',
    '6001': '1001',
    '6003': '1003',
    '6004': '1004',
    '6005': '1005',
    '6007': '1007',
    '6008': '1008',
    '6010': '1010',
    '6011': '1011',
    '6012': '1012',
    '6013': '1013',
    '6014': '1014',
    '6015': '1015',
    '6016': '1016',
    '6017': '1017',
    '6018': '1018',
    '6020': '1020',
    '6021': '1021',
    '6022': '1022',
    '6023': '1023',
    '6024': '1024',
    '6025': '1025',
    '6026': '1026',
    '6027': '1027',
    '6028': '1028',
    '6029': '1029',
    '6030': '1030',
    '6031': '1031',
    '6032': '1032',
    '6033': '1033',
    '6034': '1034',
    '6035': '1035',
    '6036': '1036',
    '6037': '1037',
    '6038': '1038',
    '6039': '1039',
    '6040': '1217',
    '6041': '1041',
    '6042': '1216',
    '6043': '1043',
    '6044': '1044',
    '6045': '1045',
    '6046': '1046',
    '6047': '1047',
    '6048': '1048',
    '6049': '1236',
    '6100': '2100',
    '6101': '2101',
    '6103': '2103',
    '6105': '2105',
    '6106': '2106',
    '6108': '2108',
    '6109': '2109',
    '6110': '2110',
    '6111': '2111',
    '6112': '2112',
    '6113': '2113',
    '6114': '2114',
    '6115': '2115',
    '6116': '2200',
    '6117': '2117',
    '6118': '2118',
    '6119': '2119',
    '6213': '2213',
    '6050': '1050',
    '6090': '1090',
    '6235': '1235',
    '6099': 'Z9CC'
}


def start(df):
    # แปลงค่าให้เป็น string แบบไม่มี .0
    df['branch_code'] = df['branch_code'].astype(str).str.replace('\.0$', '', regex=True)
    
    # ทำ mapping
    mapped = df['branch_code'].map(mapping_dict)
    # If mapping fails, set to '0000'
    df['branch_code'] = mapped.fillna('0000')
    # If branch_code is empty string or NaN, set to '0000'
    df['branch_code'] = df['branch_code'].replace(['', 'nan', 'NaN', None, pd.NA], '0000')
    return df

